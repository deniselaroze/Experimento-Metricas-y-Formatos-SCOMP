if (mode=="rp") {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en pesos<br> durante el primer a&ntildeo&dagger;",
"&emsp; P&eacuterdida anual&dagger;"),
caption="Retiro Programado",
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Monto que dejar&iacutea de ganar el primero a&ntilde;o de pensi&oacuten.",
file=paste0(path, "TreatV", v , QID ,".html"),
rnames=F
)
)
}
else {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "riesgo", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
title<-if(grepl("1", mode)) {"Renta Vitalicia Inmediata"
} else if(grepl("2", mode))  {"Retiro Programado con Renta Vitalicia Diferida de 2 a&ntilde;os"
} else {"Retiro Programado con Renta Vitalicia Diferida de 4 a&ntilde;os"}
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en  pesos&dagger;", "P&eacuterdida anual&lowast;"),
caption=title,
tfoot=paste0("&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Las categor&iacuteas de Clasificaci&oacuten de Riesgo que permiten a las Compa&ntilde;&iacutea ofrecer
Rentas Vitalicias son las siguientes AAA (mejor clasificaci&oacuten), AA, A, BBB (inferior). Cada una de estas categor&iacuteas
puede tener sub&iacutendices &quot;+&quot; o &quot;-&quot;, siendo el sub&iacutendice &quot;+&quot; mejor que el &quot;-&quot;.
&lowast;&lowast; Monto que dejar&iacutea de ganar cada a&ntilde;o de vida.
Para obtener mayor informaci&oacuten sobre la clasificaci&oacuten de riesgo de cada compa&ntilde;ia haga click en
<a href=","www.latercera.com",">here</a>", sep=""), file=paste0(path, "TreatV", v , QID ,".html"),
css.cell = "padding-left: 0.5em; padding-right: 0.5em;",rnames=F
)
)
}
}
fcn.treat2("F", "nivel2", "1a", "co_1arp", 1 )
link<-"www.rstudio.com"
paste0("&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Las categor&iacuteas de Clasificaci&oacuten de Riesgo que permiten a las Compa&ntilde;&iacutea ofrecer
Rentas Vitalicias son las siguientes AAA (mejor clasificaci&oacuten), AA, A, BBB (inferior). Cada una de estas categor&iacuteas
puede tener sub&iacutendices &quot;+&quot; o &quot;-&quot;, siendo el sub&iacutendice &quot;+&quot; mejor que el &quot;-&quot;.
&lowast;&lowast; Monto que dejar&iacutea de ganar cada a&ntilde;o de vida.
Para obtener mayor informaci&oacuten sobre la clasificaci&oacuten de riesgo de cada compa&ntilde;ia haga click en
<a href=",link,">here</a>", sep="")
paste0("&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Las categor&iacuteas de Clasificaci&oacuten de Riesgo que permiten a las Compa&ntilde;&iacutea ofrecer
Rentas Vitalicias son las siguientes AAA (mejor clasificaci&oacuten), AA, A, BBB (inferior). Cada una de estas categor&iacuteas
puede tener sub&iacutendices &quot;+&quot; o &quot;-&quot;, siendo el sub&iacutendice &quot;+&quot; mejor que el &quot;-&quot;.
&lowast;&lowast; Monto que dejar&iacutea de ganar cada a&ntilde;o de vida.
Para obtener mayor informaci&oacuten sobre la clasificaci&oacuten de riesgo de cada compa&ntilde;ia haga click en
<a href='",link,">'here</a>", sep="")
fcn.treat2 <- function(gender, econ, mode, pair, v){
link<-"www.rstudio.com"
if (mode=="rp") {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en pesos<br> durante el primer a&ntildeo&dagger;",
"&emsp; P&eacuterdida anual&dagger;"),
caption="Retiro Programado",
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Monto que dejar&iacutea de ganar el primero a&ntilde;o de pensi&oacuten.",
file=paste0(path, "TreatV", v , QID ,".html"),
rnames=F
)
)
}
else {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "riesgo", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
title<-if(grepl("1", mode)) {"Renta Vitalicia Inmediata"
} else if(grepl("2", mode))  {"Retiro Programado con Renta Vitalicia Diferida de 2 a&ntilde;os"
} else {"Retiro Programado con Renta Vitalicia Diferida de 4 a&ntilde;os"}
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en  pesos&dagger;", "P&eacuterdida anual&lowast;"),
caption=title,
tfoot=paste0("&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Las categor&iacuteas de Clasificaci&oacuten de Riesgo que permiten a las Compa&ntilde;&iacutea ofrecer
Rentas Vitalicias son las siguientes AAA (mejor clasificaci&oacuten), AA, A, BBB (inferior). Cada una de estas categor&iacuteas
puede tener sub&iacutendices &quot;+&quot; o &quot;-&quot;, siendo el sub&iacutendice &quot;+&quot; mejor que el &quot;-&quot;.
&lowast;&lowast; Monto que dejar&iacutea de ganar cada a&ntilde;o de vida.
Para obtener mayor informaci&oacuten sobre la clasificaci&oacuten de riesgo de cada compa&ntilde;ia haga click en
<a href='",link,">'here</a>", sep=""), file=paste0(path, "TreatV", v , QID ,".html"),
css.cell = "padding-left: 0.5em; padding-right: 0.5em;",rnames=F
)
)
}
}
fcn.treat2("F", "nivel2", "1a", "co_1arp", 1 )
fcn.treat2 <- function(gender, econ, mode, pair, v){
link<-"www.rstudio.com"
if (mode=="rp") {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en pesos<br> durante el primer a&ntildeo&dagger;",
"&emsp; P&eacuterdida anual&dagger;"),
caption="Retiro Programado",
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Monto que dejar&iacutea de ganar el primero a&ntilde;o de pensi&oacuten.",
file=paste0(path, "TreatV", v , QID ,".html"),
rnames=F
)
)
}
else {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "riesgo", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
title<-if(grepl("1", mode)) {"Renta Vitalicia Inmediata"
} else if(grepl("2", mode))  {"Retiro Programado con Renta Vitalicia Diferida de 2 a&ntilde;os"
} else {"Retiro Programado con Renta Vitalicia Diferida de 4 a&ntilde;os"}
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en  pesos&dagger;", "P&eacuterdida anual&lowast;"),
caption=title,
tfoot=paste0("&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Las categor&iacuteas de Clasificaci&oacuten de Riesgo que permiten a las Compa&ntilde;&iacutea ofrecer
Rentas Vitalicias son las siguientes AAA (mejor clasificaci&oacuten), AA, A, BBB (inferior). Cada una de estas categor&iacuteas
puede tener sub&iacutendices &quot;+&quot; o &quot;-&quot;, siendo el sub&iacutendice &quot;+&quot; mejor que el &quot;-&quot;.
&lowast;&lowast; Monto que dejar&iacutea de ganar cada a&ntilde;o de vida.
Para obtener mayor informaci&oacuten sobre la clasificaci&oacuten de riesgo de cada compa&ntilde;ia haga click en
<a href='",link,"'>here</a>", sep=""), file=paste0(path, "TreatV", v , QID ,".html"),
css.cell = "padding-left: 0.5em; padding-right: 0.5em;",rnames=F
)
)
}
}
fcn.treat2("F", "nivel2", "1a", "co_1arp", 1 )
paste0("&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Las categor&iacuteas de Clasificaci&oacuten de Riesgo que permiten a las Compa&ntilde;&iacutea ofrecer
Rentas Vitalicias son las siguientes AAA (mejor clasificaci&oacuten), AA, A, BBB (inferior). Cada una de estas categor&iacuteas
puede tener sub&iacutendices &quot;+&quot; o &quot;-&quot;, siendo el sub&iacutendice &quot;+&quot; mejor que el &quot;-&quot;.
&lowast;&lowast; Monto que dejar&iacutea de ganar cada a&ntilde;o de vida.
Para obtener mayor informaci&oacuten sobre la clasificaci&oacuten de riesgo de cada compa&ntilde;ia haga click en
<a href='",link,"'>here</a>", sep="")
paste0("&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Las categor&iacuteas de Clasificaci&oacuten de Riesgo que permiten a las Compa&ntilde;&iacutea ofrecer
Rentas Vitalicias son las siguientes AAA (mejor clasificaci&oacuten), AA, A, BBB (inferior). Cada una de estas categor&iacuteas
puede tener sub&iacutendices &quot;+&quot; o &quot;-&quot;, siendo el sub&iacutendice &quot;+&quot; mejor que el &quot;-&quot;.
&lowast;&lowast; Monto que dejar&iacutea de ganar cada a&ntilde;o de vida.
Para obtener mayor informaci&oacuten sobre la clasificaci&oacuten de riesgo de cada compa&ntilde;ia haga click en
<a href='",link,"'>here</a>", sep="")
fcn.treat2 <- function(gender, econ, mode, pair, v){
link<-"www.rstudio.com"
if (mode=="rp") {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en pesos<br> durante el primer a&ntildeo&dagger;",
"&emsp; P&eacuterdida anual&dagger;"),
caption="Retiro Programado",
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Monto que dejar&iacutea de ganar el primero a&ntilde;o de pensi&oacuten.",
file=paste0(path, "TreatV", v , QID ,".html"),
rnames=F
)
)
}
else {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "riesgo", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
title<-if(grepl("1", mode)) {"Renta Vitalicia Inmediata"
} else if(grepl("2", mode))  {"Retiro Programado con Renta Vitalicia Diferida de 2 a&ntilde;os"
} else {"Retiro Programado con Renta Vitalicia Diferida de 4 a&ntilde;os"}
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en  pesos&dagger;", "P&eacuterdida anual&lowast;"),
caption=title,
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Las categor&iacuteas de Clasificaci&oacuten de Riesgo que permiten a las Compa&ntilde;&iacutea ofrecer
Rentas Vitalicias son las siguientes AAA (mejor clasificaci&oacuten), AA, A, BBB (inferior). Cada una de estas categor&iacuteas
puede tener sub&iacutendices &quot;+&quot; o &quot;-&quot;, siendo el sub&iacutendice &quot;+&quot; mejor que el &quot;-&quot;.
&lowast;&lowast; Monto que dejar&iacutea de ganar cada a&ntilde;o de vida.
Para obtener mayor informaci&oacuten sobre la clasificaci&oacuten de riesgo de cada compa&ntilde;ia haga click en
<a href='www.rstudio.com'>here</a>",  file=paste0(path, "TreatV", v , QID ,".html"),
css.cell = "padding-left: 0.5em; padding-right: 0.5em;",rnames=F
)
)
}
}
fcn.treat2("F", "nivel2", "1a", "co_1arp", 1 )
fcn.treat2 <- function(gender, econ, mode, pair, v){
link<-"www.rstudio.com"
if (mode=="rp") {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en pesos<br> durante el primer a&ntildeo&dagger;",
"&emsp; P&eacuterdida anual&dagger;"),
caption="Retiro Programado",
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Monto que dejar&iacutea de ganar el primero a&ntilde;o de pensi&oacuten.",
file=paste0(path, "TreatV", v , QID ,".html"),
rnames=F
)
)
}
else {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "riesgo", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
title<-if(grepl("1", mode)) {"Renta Vitalicia Inmediata"
} else if(grepl("2", mode))  {"Retiro Programado con Renta Vitalicia Diferida de 2 a&ntilde;os"
} else {"Retiro Programado con Renta Vitalicia Diferida de 4 a&ntilde;os"}
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en  pesos&dagger;", "P&eacuterdida anual&lowast;"),
caption=title,
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Las categor&iacuteas de Clasificaci&oacuten de Riesgo que permiten a las Compa&ntilde;&iacutea ofrecer
Rentas Vitalicias son las siguientes AAA (mejor clasificaci&oacuten), AA, A, BBB (inferior). Cada una de estas categor&iacuteas
puede tener sub&iacutendices &quot;+&quot; o &quot;-&quot;, siendo el sub&iacutendice &quot;+&quot; mejor que el &quot;-&quot;.
&lowast;&lowast; Monto que dejar&iacutea de ganar cada a&ntilde;o de vida.
Para obtener mayor informaci&oacuten sobre la clasificaci&oacuten de riesgo de cada compa&ntilde;ia haga click en
<a href='https://deniselaroze.files.wordpress.com/2014/03/avatar-set-1.png'>here</a>",
file=paste0(path, "TreatV", v , QID ,".html"),
css.cell = "padding-left: 0.5em; padding-right: 0.5em;",rnames=F
)
)
}
}
fcn.treat2("F", "nivel2", "1a", "co_1arp", 1 )
fcn.treat2 <- function(gender, econ, mode, pair, v){
link<-"www.rstudio.com"
if (mode=="rp") {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en pesos<br> durante el primer a&ntildeo&dagger;",
"&emsp; P&eacuterdida anual&dagger;"),
caption="Retiro Programado",
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Monto que dejar&iacutea de ganar el primero a&ntilde;o de pensi&oacuten.",
file=paste0(path, "TreatV", v , QID ,".html"),
rnames=F
)
)
}
else {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "riesgo", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
title<-if(grepl("1", mode)) {"Renta Vitalicia Inmediata"
} else if(grepl("2", mode))  {"Retiro Programado con Renta Vitalicia Diferida de 2 a&ntilde;os"
} else {"Retiro Programado con Renta Vitalicia Diferida de 4 a&ntilde;os"}
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en  pesos&dagger;", "P&eacuterdida anual&lowast;"),
caption=title,
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Las categor&iacuteas de Clasificaci&oacuten de Riesgo que permiten a las Compa&ntilde;&iacutea ofrecer
Rentas Vitalicias son las siguientes AAA (mejor clasificaci&oacuten), AA, A, BBB (inferior). Cada una de estas categor&iacuteas
puede tener sub&iacutendices &quot;+&quot; o &quot;-&quot;, siendo el sub&iacutendice &quot;+&quot; mejor que el &quot;-&quot;.
&lowast;&lowast; Monto que dejar&iacutea de ganar cada a&ntilde;o de vida.
Para obtener mayor informaci&oacuten sobre la clasificaci&oacuten de riesgo de cada compa&ntilde;ia haga click en
<a href='https://github.com/deniselaroze/Experimento-Metricas-y-Formatos-SCOMP/blob/master/Tratamientos/clasif_riesgo_csv.png'>aqui</a>",
file=paste0(path, "TreatV", v , QID ,".html"),
css.cell = "padding-left: 0.5em; padding-right: 0.5em;",rnames=F
)
)
}
}
fcn.treat2("F", "nivel2", "1a", "co_1arp", 1 )
fcn.treat2 <- function(gender, econ, mode, pair, v){
if (mode=="rp") {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en pesos<br> durante el primer a&ntildeo&dagger;",
"&emsp; P&eacuterdida anual&dagger;"),
caption="Retiro Programado",
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Monto que dejar&iacutea de ganar el primero a&ntilde;o de pensi&oacuten.",
file=paste0(path, "TreatV", v , QID ,".html"),
rnames=F
)
)
}
else {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "riesgo", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
title<-if(grepl("1", mode)) {"Renta Vitalicia Inmediata"
} else if(grepl("2", mode))  {"Retiro Programado con Renta Vitalicia Diferida de 2 a&ntilde;os"
} else {"Retiro Programado con Renta Vitalicia Diferida de 4 a&ntilde;os"}
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en  pesos&dagger;", "P&eacuterdida anual&lowast;"),
caption=title,
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Las categor&iacuteas de Clasificaci&oacuten de Riesgo que permiten a las Compa&ntilde;&iacutea ofrecer
Rentas Vitalicias son las siguientes AAA (mejor clasificaci&oacuten), AA, A, BBB (inferior). Cada una de estas categor&iacuteas
puede tener sub&iacutendices &quot;+&quot; o &quot;-&quot;, siendo el sub&iacutendice &quot;+&quot; mejor que el &quot;-&quot;.
&lowast;&lowast; Monto que dejar&iacutea de ganar cada a&ntilde;o de vida.
Para obtener mayor informaci&oacuten sobre la clasificaci&oacuten de riesgo de cada compa&ntilde;ia haga click <a href='https://github.com/deniselaroze/Experimento-Metricas-y-Formatos-SCOMP/blob/master/Tratamientos/clasif_riesgo_csv.png'>aqui</a>",
file=paste0(path, "TreatV", v , QID ,".html"),
css.cell = "padding-left: 0.5em; padding-right: 0.5em;",rnames=F
)
)
}
}
fcn.treat2("F", "nivel2", "1a", "co_1arp", 1 )
fcn.treat2 <- function(gender, econ, mode, pair, v){
if (mode=="rp") {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en pesos<br> durante el primer a&ntildeo&dagger;",
"&emsp; P&eacuterdida anual&dagger;"),
caption="Retiro Programado",
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Monto que dejar&iacutea de ganar el primero a&ntilde;o de pensi&oacuten.",
file=paste0(path, "TreatV", v , QID ,".html"),
rnames=F
)
)
}
else {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "riesgo", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
title<-if(grepl("1", mode)) {"Renta Vitalicia Inmediata"
} else if(grepl("2", mode))  {"Retiro Programado con Renta Vitalicia Diferida de 2 a&ntilde;os"
} else {"Retiro Programado con Renta Vitalicia Diferida de 4 a&ntilde;os"}
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en  pesos&dagger;", "P&eacuterdida anual&lowast;"),
caption=title,
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Las categor&iacuteas de Clasificaci&oacuten de Riesgo que permiten a las Compa&ntilde;&iacutea ofrecer
Rentas Vitalicias son las siguientes AAA (mejor clasificaci&oacuten), AA, A, BBB (inferior). Cada una de estas categor&iacuteas
puede tener sub&iacutendices &quot;+&quot; o &quot;-&quot;, siendo el sub&iacutendice &quot;+&quot; mejor que el &quot;-&quot;.
&lowast;&lowast; Monto que dejar&iacutea de ganar cada a&ntilde;o de vida.
Para obtener mayor informaci&oacuten sobre la clasificaci&oacuten de riesgo de cada compa&ntilde;ia haga click <a href='https://github.com/deniselaroze/Experimento-Metricas-y-Formatos-SCOMP/blob/master/Tratamientos/clasif_riesgo_csv.png' target='_blank'>aqui</a>",
file=paste0(path, "TreatV", v , QID ,".html"),
css.cell = "padding-left: 0.5em; padding-right: 0.5em;",rnames=F
)
)
}
}
fcn.treat2("F", "nivel2", "1a", "co_1arp", 1 )
fcn.treat2 <- function(gender, econ, mode, pair, v){
if (mode=="rp") {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en pesos<br> durante el primer a&ntildeo&dagger;",
"&emsp; P&eacuterdida anual&dagger;"),
caption="Retiro Programado",
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Monto que dejar&iacutea de ganar el primero a&ntilde;o de pensi&oacuten.",
file=paste0(path, "TreatV", v , QID ,".html"),
rnames=F
)
)
}
else {
id<-paste0(gender, econ, ".", mode, ".", pair)
tbl<-all.files[all.files$id==id, c("razon_social", "val_pesos_pension", "riesgo", "VPN")]
tbl$val_pesos_pension<-round( tbl$val_pesos_pension, 0)
tbl$pesosDiff<- tbl$val_pesos_pension - max(tbl$val_pesos_pension)
tbl$pesosDiff<-round( tbl$pesosDiff, 0)*12
opcion <- seq.int(nrow(tbl))
tbl<-cbind(opcion, tbl)
output <- numcolwise(prettyNum)(tbl, big.mark = ".",
decimal.mark = ",")
output<-cbind(output[,1], tbl[,2], output[, c(2,4)])
title<-if(grepl("1", mode)) {"Renta Vitalicia Inmediata"
} else if(grepl("2", mode))  {"Retiro Programado con Renta Vitalicia Diferida de 2 a&ntilde;os"
} else {"Retiro Programado con Renta Vitalicia Diferida de 4 a&ntilde;os"}
return(htmlTable(output,
header =  c("Opci&oacuten", "Raz&oacuten Social", "Pensi&oacuten mensual en  pesos&dagger;", "P&eacuterdida anual&lowast;"),
caption=title,
tfoot="&dagger; Valor calculado en base a UF del d&iacutea 03/08/2018.
&lowast; Las categor&iacuteas de Clasificaci&oacuten de Riesgo que permiten a las Compa&ntilde;&iacutea ofrecer
Rentas Vitalicias son las siguientes AAA (mejor clasificaci&oacuten), AA, A, BBB (inferior). Cada una de estas categor&iacuteas
puede tener sub&iacutendices &quot;+&quot; o &quot;-&quot;, siendo el sub&iacutendice &quot;+&quot; mejor que el &quot;-&quot;.
&lowast;&lowast; Monto que dejar&iacutea de ganar cada a&ntilde;o de vida.
Para obtener mayor informaci&oacuten sobre la clasificaci&oacuten de riesgo de las compa&ntilde;ias de seguro haga click <a href='https://github.com/deniselaroze/Experimento-Metricas-y-Formatos-SCOMP/blob/master/Tratamientos/clasif_riesgo_csv.png' target='_blank'>aqui</a>",
file=paste0(path, "TreatV", v , QID ,".html"),
css.cell = "padding-left: 0.5em; padding-right: 0.5em;",rnames=F
)
)
}
}
fcn.treat2("F", "nivel2", "1a", "co_1arp", 1 )
